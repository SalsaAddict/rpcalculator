var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),module=angular.module("rpcalc",["ngRoute","ngMessages","ngStorage"]),Example,RPCalculator;module.config(["$routeProvider",function(n){n.when("/workbook",{templateUrl:"Views/workbook.html",controller:RPCalculator.Workbook.Controller,controllerAs:"$ctrl"}).when("/worksheets/:index",{templateUrl:"Views/worksheet.html",controller:RPCalculator.Worksheet.Controller,controllerAs:"$ctrl"}).when("/judges/:index",{templateUrl:"Views/judges.html",controller:RPCalculator.Judges.Controller,controllerAs:"$ctrl"}).when("/competitors/:index",{templateUrl:"Views/competitors.html",controller:RPCalculator.Competitors.Controller,controllerAs:"$ctrl"}).otherwise({redirectTo:"/workbook"}).caseInsensitiveMatch=!0}]);module.run(["$rootScope",function(n){n.textPattern=RPCalculator.textPattern;n.numberPattern=RPCalculator.numberPattern;n.vclass=function(n,t,i){t===void 0&&(t="is-valid");i===void 0&&(i="is-invalid");var r={};return t!==null&&Object.defineProperty(r,t,{get:function(){return n.$valid},enumerable:!0}),i!==null&&Object.defineProperty(r,i,{get:function(){return n.$invalid},enumerable:!0}),r}}]),function(n){n.workbook={title:"Skating System Example",worksheets:[{title:"Simple Example",judges:[{name:"John"},{name:"BeyoncÃ©"},{name:"Paul"},{name:"Kelly"},{name:"George"},{name:"Michelle"},{name:"Ringo"}],competitors:[]},{title:"Intermediate Example",judges:[],competitors:[]},{title:"Complex Example",judges:[],competitors:[]},]}}(Example||(Example={})),function(n){"use strict";function i(n){return angular.isUndefined(n)?!0:n===null?!0:angular.isArray(n)?n.length===0:angular.isObject(n)?angular.toJson(n)===angular.toJson({}):String(n).trim()===""?!0:n===NaN?!0:!1}function r(n,t){return i(n)?t:n}function t(n,t,i){var r=n[t];n[t]=n[i];n[i]=r}function u(n,i){t(n,i,i-1)}function f(n,i){t(n,i,i+1)}n.maxJudges=7;n.maxCompetitors=8;n.textPattern="(^[\\w\\s-]+$)";n.numberPattern="(^\\d+$)";n.isBlank=i;n.ifBlank=r;n.swap=t;n.swapUp=u;n.swapDown=f}(RPCalculator||(RPCalculator={})),function(n){"use strict";function i(t){var i=new RegExp(n.numberPattern);if(i.test(t))return parseInt(i.exec(t)[1],10)}var r,t,u,f;n.toInt=i,function(t){var r=function(){function t(n,t){this.$localStorage=n;this.$location=t}return t.prototype.go=function(n,t){n===void 0&&(n="/workbook");t>=0&&(n+="/"+t);this.$location.path(n)},Object.defineProperty(t.prototype,"workbook",{get:function(){return this.$localStorage.workbook=n.ifBlank(this.$localStorage.workbook,Example.workbook),this.$localStorage.workbook},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return angular.isUndefined(this.workbook.title)&&(this.workbook.title="New Workbook"),this.workbook.title},set:function(n){this.workbook.title=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"worksheets",{get:function(){return angular.isArray(this.workbook.worksheets)||(this.workbook.worksheets=[]),this.workbook.worksheets},enumerable:!0,configurable:!0}),t.prototype.validateJudges=function(t){return n.isBlank(this.judgesValidationError(t))},t.prototype.judgesValidationError=function(t){var r,i;if(n.isBlank(t)||!angular.isArray(t)||t.length<3)return"There must be at least 3 judges";if(t.length>n.maxJudges)return"There cannot be more than "+n.maxJudges+" judges";if(t.length%2==0)return"There must be an odd number of judges";for(r=[],i=0;i<t.length;i++){if(n.isBlank(t[i])||n.isBlank(t[i].name))return"Each judge must have a name";if(r.indexOf(t[i].name)>=0)return"Each judge must have a unique name";r.push(t[i].name)}return},t.prototype.competitorsValidationError=function(t){var r,u,i;if(n.isBlank(t)||!angular.isArray(t)||t.length<2)return"There must be at least 2 competitors";if(t.length>n.maxCompetitors)return"There cannot be more than "+n.maxCompetitors+" competitors";for(r=[],u=[],i=0;i<t.length;i++){if(n.isBlank(t[i])||n.isBlank(t[i].id))return"Each competitor must have a number";if(r.indexOf(t[i].id)>=0)return"Each competitor must have a unique number";if(n.isBlank(t[i].name))return"Each competitor must have a name";if(u.indexOf(t[i].name)>=0)return"Each competitor must have a unique name";r.push(t[i].id);u.push(t[i].name)}return},t.prototype.validateCompetitors=function(t){return n.isBlank(this.competitorsValidationError(t))},t.$inject=["$localStorage","$location"],t}(),i;t.Service=r;i=function(){function n(n){this.$wb=n}return n.$inject=["$wb"],n}();t.Controller=i}(r=n.Workbook||(n.Workbook={})),function(t){var r=function(){function t(n,t,i,r,u){var f=this;this.$scope=n;this.$wb=t;this.$route=i;this.$routeParams=r;this.$window=u;(angular.isUndefined(this.index)||angular.isUndefined(this.$wb.worksheets[this.index]))&&this.$wb.go();n.$on("$destroy",n.$on("$routeChangeStart",function(n){f.form&&f.form.$dirty&&(n.preventDefault(),f.$window.alert("Please save or undo your changes before continuing."))}))}return t.prototype.goToWorksheet=function(){this.$wb.go("/worksheets",this.index)},Object.defineProperty(t.prototype,"form",{get:function(){return this.$scope.form},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return i(this.$routeParams.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"worksheet",{get:function(){return this.$wb.worksheets[this.index]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"judges",{get:function(){return n.ifBlank(this.worksheet.judges,[])},set:function(t){this.worksheet.judges=angular.copy(n.ifBlank(t,[]))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"competitors",{get:function(){return n.ifBlank(this.worksheet.competitors,[])},set:function(t){this.worksheet.competitors=angular.copy(n.ifBlank(t,[]))},enumerable:!0,configurable:!0}),t.$inject=["$scope","$wb","$route","$routeParams","$window"],t}(),u,f;t.BaseController=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"validator",{get:function(){return this.$wb[this.property.toLowerCase()+"ValidationError"]},enumerable:!0,configurable:!0}),i.prototype.getData=function(t,i,r){return this.property=n.ifBlank(t,this.property),this.min=n.ifBlank(i,this.min),this.max=n.ifBlank(r,this.max),angular.copy(this[this.property.toLowerCase()])},Object.defineProperty(i.prototype,"message",{get:function(){return n.ifBlank(this.validator(this.data),this.property)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"valid",{get:function(){return n.isBlank(this.validator(this.data))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"invalid",{get:function(){return!this.valid},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"canAdd",{get:function(){return this.data.length<this.max},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"canRemove",{get:function(){return this.data.length>this.min},enumerable:!0,configurable:!0}),i.prototype.remove=function(n){this.data.splice(n,1);this.form.$setDirty()},i.prototype.moveUp=function(t){n.swapUp(this.data,t);this.form.$setDirty()},i.prototype.moveDown=function(t){n.swapDown(this.data,t);this.form.$setDirty()},i.prototype.save=function(){this[this.property.toLowerCase()]=angular.copy(n.ifBlank(this.data,[]));this.form.$setPristine()},i.prototype.undo=function(){this.data=this.getData();this.form.$setPristine()},i}(r);t.EditController=u;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.scores=function(t){return n.isBlank(t.scores)&&(t.scores=[]),t.scores},i}(r);t.Controller=f}(t=n.Worksheet||(n.Worksheet={})),function(i){var r=function(t){function i(){var i=t!==null&&t.apply(this,arguments)||this;return i.data=i.getData("Judges",3,n.maxJudges),i}return __extends(i,t),i.prototype.add=function(){this.data.push({name:null});this.form.$setDirty()},i}(t.EditController);i.Controller=r}(u=n.Judges||(n.Judges={})),function(i){var r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"valid",{get:function(){return this.$wb.validateCompetitors(this.competitors)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"invalid",{get:function(){return!this.valid},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"message",{get:function(){return n.ifBlank(this.$wb.competitorsValidationError(this.competitors),"Competitors")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"canAdd",{get:function(){return this.competitors.length<n.maxCompetitors},enumerable:!0,configurable:!0}),i.prototype.add=function(){angular.isArray(this.worksheet.competitors)||(this.worksheet.competitors=[]);var n=this.competitors.push({id:null,name:null,scores:[]});this.competitors[n-1].id=n;this.form.$setDirty()},Object.defineProperty(i.prototype,"canRemove",{get:function(){return this.competitors.length>2},enumerable:!0,configurable:!0}),i.prototype.remove=function(n){this.competitors.splice(n,1);this.form.$setDirty()},i.prototype.moveUp=function(t){n.swap(this.competitors,t,t-1);this.form.$setDirty()},i.prototype.moveDown=function(t){n.swap(this.competitors,t,t+1);this.form.$setDirty()},i.prototype.save=function(){this.$wb.worksheets[this.index].competitors=angular.copy(n.ifBlank(this.competitors,[]));this.form.$setPristine()},i.prototype.undo=function(){this.competitors=angular.copy(n.ifBlank(this.worksheet.competitors,[]));this.form.$setPristine()},i}(t.BaseController);i.Controller=r}(f=n.Competitors||(n.Competitors={}))}(RPCalculator||(RPCalculator={}));module.service("$wb",RPCalculator.Workbook.Service);